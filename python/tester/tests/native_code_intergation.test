test native function calls user function
    import _testing
    f = {
        print("I'm a user function")
    }
    _testing.demo_print(f)
expect
    I'm a native function
    I'm a user function
    I'm a native function
end

test native function calls user function with arguments and return value
    import _testing
    f = { takes a, b to
        print("I'm a user callback")
        return a + b
    }
    retval = _testing.call_callback_with_args(f, 10, 5)
    print(retval)
expect
    I'm a native function
    I'm a user callback
    15
end

test native function calls user function that fails
    # This is a super brittle test, for now. Look at the super specific (and certain to change) ugly error output.

    import _testing
    callback = { takes a, b to
        return "" + a + b
    }
    retval = _testing.call_callback_with_args(callback, 10, 20)
    print(retval)
expect
    I'm a native function
    An error has occured. Stack trace (most recent call on top):
        -> callback
        -> <Anonymous function>
        -> <Anonymous function>
    Runtime error: @add function failed.
    An error has occured. Stack trace (most recent call on top):
        -> <Anonymous function>
    Runtime error: Native function failed.
end